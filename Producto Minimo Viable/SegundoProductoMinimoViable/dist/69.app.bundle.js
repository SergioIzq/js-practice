"use strict";(self.webpackChunkproyectomvp=self.webpackChunkproyectomvp||[]).push([[69,805,699],{683:(e,t,a)=>{a.d(t,{Z:()=>s});const s=class{async fetchFile(e){let t=await fetch(e);return await t.text()}}},69:(e,t,a)=>{a.r(t),a.d(t,{Home:()=>r});var s=a(683),n=a(699),o=a(805);class r extends s.Z{#e="components/home/home.html";#t=null;#a=null;#s="Welcome";constructor(){super(),this.#t=new n.User,this.#a=new o.Task}async render(){let e=await this.fetchFile(this.#e);return this.#n(e)}async#n(e){let t=await this.#a.getAll(this.#t.id);return(e=e.replace(/{name}/,`${this.#s} ${this.#t.name}`)).replace(/{tasks}/,this.#o(t))}#o(e){let t="";for(let a of e.todos)t+=`\n                <div class="task${a.id}">\n                    ${a.completed?"<strike>":""}${a.todo}${a.completed?"</strike>":""}\n                </div>\n                <div class="task${a.id}">\n                    ${a.completed?"":`<button type="button" data-id="${a.id}" name="complete_task">`}\n                    ${a.completed?"‚úîÔ∏è":"‚≠ï"}\n                    ${a.completed?"":"</button>"}\n                </div>\n                <div class ="task${a.id}">\n                    <button type="button" data-id="${a.id}" name="delete_task">üóëÔ∏è</button>\n                </div>\n            `;return t}async homeHandler(e){document.querySelectorAll("button[name=complete_task]").forEach((e=>e.addEventListener("click",(async e=>{let t=e.target.attributes["data-id"].value;await this.#a.completed(t,!0),e.target.parentNode.innerHTML="‚úîÔ∏è"})))),document.querySelectorAll("button[name=delete_task]").forEach((e=>e.addEventListener("click",(async e=>{let t=e.target.attributes["data-id"].value;await this.#a.delete(t),document.querySelectorAll(`div.task${t}`).forEach((e=>e.remove()))}))))}}},805:(e,t,a)=>{a.r(t),a.d(t,{Task:()=>o});var s=a(683),n=a(699);class o extends s.Z{#t=null;constructor(){super(),this.#t=new n.User}async render(e){return await this.fetchFile(`components/task/${e}.html`)}createHandler(e){document.querySelector("form.new.task").addEventListener("submit",(async t=>{t.preventDefault();const a=String(t.target.elements[0].value),s=Number(document.querySelector('form.new.task input[name="completed"]:checked').value);let n=await this.#r(a,s);return"id"in n?(e.load("home"),!0):(alert(n.message),!1)})),document.querySelector("form.new.task button.cancel").addEventListener("click",(async t=>{e.load("home")}))}async getAll(e){let t=await fetch(`https://dummyjson.com/todos/user/${e}?limit=10`,{method:"GET",headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`,"Content-Type":"application/json"}});return await t.json()}async completed(e,t){let a=await fetch(`https://dummyjson.com/todos/${e}`,{method:"PUT",headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({completed:t})});return await a.json()}async delete(e){let t=await fetch(`https://dummyjson.com/todos/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`,"Content-Type":"application/json"}});return await t.json()}async#r(e,t){this.#i(e,t);let a=await fetch("https://dummyjson.com/todos/add",{method:"POST",headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({todo:e,completed:t,userId:this.#t.id})});return await a.json()}#i(e,t){if(!e instanceof String)throw new Error("Task title only allow text with chars and numbers");if(!t instanceof Boolean)throw new Error("Task completed only allow boolean values")}}},699:(e,t,a)=>{a.r(t),a.d(t,{User:()=>n});var s=a(683);class n extends s.Z{#l=null;#c=null;#d=null;#m=null;constructor(){super();let e=this.#u();this.#l=e.username,this.#c=e.firstName,this.#d=e.lastName,this.#m=e.id}get name(){return`${this.#c} ${this.#d}`}get id(){return this.#m}get username(){return this.#l}#u(){let e=sessionStorage.getItem("token");try{return JSON.parse(atob(e.split(".")[1]))}catch(e){console.error("JWT desconocido")}}}}}]);